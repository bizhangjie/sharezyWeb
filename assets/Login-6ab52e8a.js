import{d as S,s as C,u as U,C as j,S as q,r as B,a as t,o as L,b as N,f as a,w as o,e as p,j as _,h as R,y as c,_ as V}from"./index-c17d8447.js";const I={class:"login-page"},A={class:"login-header"},D=S({__name:"Login",setup(E){const d=C(),i=U(),m=j(),f=q(),e=B({username:"",password:"",agree:!1}),g=async h=>{if(e.value.agree)try{const s=await R.post("/auth/login",{username:e.value.username,password:e.value.password}),n=s.data.data.token;n&&localStorage.setItem("jwt_token",n),m.updateUserData(s.data.data.user),f.login(),c.success("登录成功🥳");const u=i.query.redirect||"/";d.push(u)}catch{c.error("请输入有效的用户名和密码")}else c.error("请同意使用该网站的规则")},v=()=>{d.push("/register")};return(h,s)=>{const n=t("a-page-header"),u=t("a-input"),l=t("a-form-item"),w=t("a-input-password"),b=t("a-checkbox"),k=t("a-button"),y=t("a-form"),x=t("a-card");return L(),N("div",I,[a(x,{class:"login-card"},{default:o(()=>[p("div",A,[a(n,{"back-icon":!1,title:"用户登录"})]),a(y,{model:e.value,name:"basic","label-col":{span:6},"wrapper-col":{span:18},onFinish:g},{default:o(()=>[a(l,{label:"用户名",name:"username",rules:[{required:!0,message:"请输入用户名"}]},{default:o(()=>[a(u,{value:e.value.username,"onUpdate:value":s[0]||(s[0]=r=>e.value.username=r)},null,8,["value"])]),_:1}),a(l,{label:"密码",name:"password",rules:[{required:!0,message:"请输入密码"}]},{default:o(()=>[a(w,{value:e.value.password,"onUpdate:value":s[1]||(s[1]=r=>e.value.password=r)},null,8,["value"])]),_:1}),a(l,{"wrapper-col":{offset:6,span:18}},{default:o(()=>[a(b,{checked:e.value.agree,"onUpdate:checked":s[2]||(s[2]=r=>e.value.agree=r)},{default:o(()=>[_("我同意使用该网站的规则")]),_:1},8,["checked"])]),_:1}),a(l,{"wrapper-col":{offset:6,span:18}},{default:o(()=>[a(k,{type:"primary",disabled:!e.value.agree,"html-type":"submit"},{default:o(()=>[_("登录")]),_:1},8,["disabled"]),p("a",{class:"register-link",onClick:v},"没有账号？点击注册")]),_:1})]),_:1},8,["model"])]),_:1})])}}});const P=V(D,[["__scopeId","data-v-9a8f92ec"]]);export{P as default};
